// ðŸŽµ THE VIBE ALGORITHM (Client Side)
export const VIBE_DB: Record<string, any[]> = {
  Dreamy: [
    { title: "Weightless", artist: "Marconi Union", url: "https://www.youtube.com/watch?v=qYnA9wWFHLI" },
    { title: "Daydreaming", artist: "Radiohead", url: "https://www.youtube.com/watch?v=TTAU7lLDZYU" },
    { title: "Space Song", artist: "Beach House", url: "https://www.youtube.com/watch?v=RBtlPT23PTM" },
    { title: "Cherry", artist: "Chromatics", url: "https://www.youtube.com/watch?v=CjQMZEJbXno" },
    { title: "Mystery of Love", artist: "Sufjan Stevens", url: "https://www.youtube.com/watch?v=4WJ30C66rKs" },
    { title: "Apocalypse", artist: "Cigarettes After Sex", url: "https://www.youtube.com/watch?v=sElE_BfQ67s" },
    { title: "Fade Into You", artist: "Mazzy Star", url: "https://www.youtube.com/watch?v=ImKY6TZEyrI" },
    { title: "Silver Springs", artist: "Fleetwood Mac", url: "https://www.youtube.com/watch?v=eDmwFhDxh-Q" },
    { title: "Dreams", artist: "Fleetwood Mac", url: "https://www.youtube.com/watch?v=GwZlpPr751A" },
    { title: "Heroes", artist: "David Bowie", url: "https://www.youtube.com/watch?v=lXgkuM2NhYI" }
  ],
  Sad: [
    { title: "GymnopÃ©die No.1", artist: "Erik Satie", url: "https://www.youtube.com/watch?v=S-Xm7s9eGxU" },
    { title: "Holocene", artist: "Bon Iver", url: "https://www.youtube.com/watch?v=TWcyIpul8OE" },
    { title: "Liability", artist: "Lorde", url: "https://www.youtube.com/watch?v=BtvJaNeELic" },
    { title: "Skinny Love", artist: "Bon Iver", url: "https://www.youtube.com/watch?v=ssdgFoHLwnk" },
    { title: "Fourth of July", artist: "Sufjan Stevens", url: "https://www.youtube.com/watch?v=JTeKpWp8Psw" },
    { title: "Fix You", artist: "Coldplay", url: "https://www.youtube.com/watch?v=k4V3Mo61fJM" },
    { title: "I Will Follow You Into The Dark", artist: "Death Cab for Cutie", url: "https://www.youtube.com/watch?v=NDHY1D0tKRA" },
    { title: "Between The Bars", artist: "Elliott Smith", url: "https://www.youtube.com/watch?v=hPD-a1FjUtU" },
    { title: "Exile", artist: "Taylor Swift ft. Bon Iver", url: "https://www.youtube.com/watch?v=osdoLjUNFnA" },
    { title: "Slow Dancing in a Burning Room", artist: "John Mayer", url: "https://www.youtube.com/watch?v=32GZ3suxRn4" }
  ],
  Energetic: [
    { title: "Midnight City", artist: "M83", url: "https://www.youtube.com/watch?v=dX3k_QDnzHE" },
    { title: "Can't Stop", artist: "Red Hot Chili Peppers", url: "https://www.youtube.com/watch?v=BfOdWSiyWQA" },
    { title: "D.A.N.C.E", artist: "Justice", url: "https://www.youtube.com/watch?v=sy1dYFGkPUE" },
    { title: "Lisztomania", artist: "Phoenix", url: "https://www.youtube.com/watch?v=4BJDNw7o6so" },
    { title: "Electric Feel", artist: "MGMT", url: "https://www.youtube.com/watch?v=MmZexg8sxyk" },
    { title: "Tongue Tied", artist: "Grouplove", url: "https://www.youtube.com/watch?v=1x1wjGKHjBI" },
    { title: "Walking On A Dream", artist: "Empire of the Sun", url: "https://www.youtube.com/watch?v=eimgRedLkkU" },
    { title: "Mr. Brightside", artist: "The Killers", url: "https://www.youtube.com/watch?v=gGdGFtwCNBE" },
    { title: "Dog Days Are Over", artist: "Florence + The Machine", url: "https://www.youtube.com/watch?v=iWOyfLBYtuU" },
    { title: "Kids", artist: "MGMT", url: "https://www.youtube.com/watch?v=fe4EK4HSPkI" }
  ],
  Floating: [
    { title: "Cornfield Chase", artist: "Hans Zimmer", url: "https://www.youtube.com/watch?v=1V_xRb0x9aw" },
    { title: "Intro", artist: "The xx", url: "https://www.youtube.com/watch?v=hhnZkNj7kAo" },
    { title: "An Ending (Ascent)", artist: "Brian Eno", url: "https://www.youtube.com/watch?v=aKw5mbcE7EY" },
    { title: "Xtal", artist: "Aphex Twin", url: "https://www.youtube.com/watch?v=Nevnq7MvVTI" },
    { title: "Time", artist: "Hans Zimmer", url: "https://www.youtube.com/watch?v=RxabLA7UQ9k" },
    { title: "On The Nature of Daylight", artist: "Max Richter", url: "https://www.youtube.com/watch?v=rVN1B-tUpgs" },
    { title: "Avril 14th", artist: "Aphex Twin", url: "https://www.youtube.com/watch?v=PeLuQ6X2ixI" },
    { title: "Clair de Lune", artist: "Debussy", url: "https://www.youtube.com/watch?v=CvFH_6DNRCY" },
    { title: "Experience", artist: "Ludovico Einaudi", url: "https://www.youtube.com/watch?v=_VONMkKkdf4" },
    { title: "Opus", artist: "Eric Prydz", url: "https://www.youtube.com/watch?v=iRA82xLsb_w" }
  ],
  Default: [
    { title: "Resonance", artist: "Home", url: "https://www.youtube.com/watch?v=8GW6sLrK40k" },
    { title: "After Dark", artist: "Mr. Kitty", url: "https://www.youtube.com/watch?v=s51VEr2Nhss" },
    { title: "SimpsonWave", artist: "Lofi", url: "https://www.youtube.com/watch?v=aWIE0PX1uXk" },
    { title: "Sunset Lover", artist: "Petit Biscuit", url: "https://www.youtube.com/watch?v=wuCK-7RQMZ0" }
  ]
};

// ðŸ§  SENTIMENT ANALYSIS
export function determineMood(text: string): string {
  const t = text.toLowerCase();
  
  // SAD / MELANCHOLY
  if (t.includes("sad") || t.includes("tired") || t.includes("rain") || t.includes("cry") || t.includes("lonely") || t.includes("hurt") || t.includes("pain") || t.includes("miss") || t.includes("grief") || t.includes("lost")) return "Sad";
  
  // ENERGETIC / HAPPY
  if (t.includes("happy") || t.includes("excited") || t.includes("run") || t.includes("dance") || t.includes("party") || t.includes("fun") || t.includes("great") || t.includes("amazing") || t.includes("win")) return "Energetic";
  
  // DREAMY / NOSTALGIC
  if (t.includes("sleep") || t.includes("dream") || t.includes("night") || t.includes("star") || t.includes("love") || t.includes("memory") || t.includes("remember") || t.includes("soft") || t.includes("calm")) return "Dreamy";
  
  // FLOATING / FOCUS / INTENSE
  if (t.includes("focus") || t.includes("work") || t.includes("study") || t.includes("space") || t.includes("think") || t.includes("mind") || t.includes("universe") || t.includes("deep")) return "Floating";

  // If no match, pick a Random Mood (excluding Default)
  const moods = Object.keys(VIBE_DB).filter(k => k !== "Default");
  return moods[Math.floor(Math.random() * moods.length)];
}

// ðŸ”€ SHUFFLE HELPER
export const shuffle = (array: any[]) => array.sort(() => Math.random() - 0.5);

// ðŸ”‘ GUEST SESSION MANAGER (Required for Supabase Guest Mode)
export function getSessionId(): string {
  if (typeof window === 'undefined') return ""; 
  
  let id = localStorage.getItem("sonic_guest_id");
  if (!id) {
    id = crypto.randomUUID();
    localStorage.setItem("sonic_guest_id", id);
  }
  return id;
}